@model IEnumerable<shared.Models.Ator>
@using System.Security.Claims

@{
    string role = User.IsInRole("Curador") ? "Curador" :
                  User.IsInRole("Utilizador") ? "Utilizador" : "Visitante";

    ViewData["Title"] = "Lista de Atores";
}

<div class="hero-section">
    <div class="container">
        <h2 class="mb-3">
            <i class="fas fa-user"></i> Lista de Atores
        </h2>

        <a class="btn btn-imdb" asp-action="Create">
            <i class="fas fa-plus-circle"></i> Registar Novo Ator
        </a>
    </div>
</div>

<!-- Search Form -->
<form asp-action="Index" method="get" class="container my-3 d-flex">
    <input type="text"
           name="search"
           class="form-control me-2"
           placeholder="Procurar por nome..."
           value="@ViewData["CurrentSearch"]" />
    <button type="submit" class="btn btn-outline-warning">
        <i class="fas fa-search"></i> Buscar
    </button>
</form>

@if (!Model.Any())
{
    <div class="alert alert-info text-center" role="alert">
        <i class="fas fa-info-circle"></i> Nenhum ator encontrado.
    </div>
}
else
{
    <div class="table-responsive">
        <table class="table table-dark table-striped table-hover">
            <thead>
                <tr>
                    <th><i class="fas fa-user"></i> Nome</th>
                    <th><i class="fas fa-calendar"></i> Data de Nascimento</th>
                    <th class="text-center"><i class="fas fa-cog"></i> Ações</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var ator in Model)
                {
                    <tr>
                        <td class="movie-title">@ator.Nome</td>
                        <td>@ator.DataNasc.ToString("dd/MM/yyyy")</td>
                        <td class="text-center">
                            <a asp-action="Details"
                               asp-route-id="@ator.Id"
                               class="btn btn-sm btn-outline-warning me-1"
                               title="Ver Detalhes">
                                <i class="fas fa-eye"></i> Detalhes
                            </a>
                            
                            @if (role == "Curador") {
                                <a asp-action="Edit"
                                asp-route-id="@ator.Id"
                                class="btn btn-sm btn-outline-primary me-1"
                                title="Editar">
                                    <i class="fas fa-edit"></i> Editar
                                </a>

                                <form asp-action="Delete"
                                    asp-route-id="@ator.Id"
                                    method="post"
                                    class="d-inline"
                                    onsubmit="return confirm('Tem certeza que deseja apagar este ator?');">
                                    <button type="submit"
                                            class="btn btn-sm btn-outline-danger"
                                            title="Apagar">
                                        <i class="fas fa-trash"></i> Apagar
                                    </button>
                                </form>
                            }
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
}
